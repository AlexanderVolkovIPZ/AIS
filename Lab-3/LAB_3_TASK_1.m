% Створення нечіткої системи керування кранами
fis = mamfis('Name', 'WaterMixer');

% 1. Вхідна змінна: Температура води
fis = addInput(fis, [0 100], 'Name', 'Температура');
fis = addMF(fis, 'Температура', 'trapmf', [-30 0 15 25], 'Name', 'Холодна');
fis = addMF(fis, 'Температура', 'trimf', [15 25 35], 'Name', 'Прохолодна');
fis = addMF(fis, 'Температура', 'trimf', [25 40 55], 'Name', 'Тепла');
fis = addMF(fis, 'Температура', 'trimf', [45 60 75], 'Name', 'Не дуже гаряча');
fis = addMF(fis, 'Температура', 'trapmf', [70 80 100 130], 'Name', 'Гаряча');

% 2. Вхідна змінна: Напір води
fis = addInput(fis, [0 10], 'Name', 'Напір');
fis = addMF(fis, 'Напір', 'trimf', [0 1 3], 'Name', 'Слабкий');
fis = addMF(fis, 'Напір', 'trimf', [2 5 8], 'Name', 'Не дуже сильний');
fis = addMF(fis, 'Напір', 'trimf', [6 8 10], 'Name', 'Сильний');

% 3. Вихідна змінна: Поворот гарячого крану
fis = addOutput(fis, [-90 90], 'Name', 'ГарячийКран');
fis = addMF(fis, 'ГарячийКран', 'trimf', [-90 -45 0], 'Name', 'ВеликийВліво');
fis = addMF(fis, 'ГарячийКран', 'trimf', [-45 -15 15], 'Name', 'СереднійВліво');
fis = addMF(fis, 'ГарячийКран', 'trimf', [0 15 45], 'Name', 'НевеликийВліво');
fis = addMF(fis, 'ГарячийКран', 'trimf', [-15 0 15], 'Name', 'Нейтрально');
fis = addMF(fis, 'ГарячийКран', 'trimf', [15 45 75], 'Name', 'НевеликийВправо');
fis = addMF(fis, 'ГарячийКран', 'trimf', [45 75 90], 'Name', 'ВеликийВправо');

% 4. Вихідна змінна: Поворот холодного крану
fis = addOutput(fis, [-90 90], 'Name', 'ХолоднийКран');
fis = addMF(fis, 'ХолоднийКран', 'trimf', [-90 -45 0], 'Name', 'ВеликийВліво');
fis = addMF(fis, 'ХолоднийКран', 'trimf', [-45 -15 15], 'Name', 'СереднійВліво');
fis = addMF(fis, 'ХолоднийКран', 'trimf', [0 15 45], 'Name', 'НевеликийВліво');
fis = addMF(fis, 'ХолоднийКран', 'trimf', [-15 0 15], 'Name', 'Нейтрально');
fis = addMF(fis, 'ХолоднийКран', 'trimf', [15 45 75], 'Name', 'НевеликийВправо');
fis = addMF(fis, 'ХолоднийКран', 'trimf', [45 75 90], 'Name', 'ВеликийВправо');

% 5. Додавання правил
ruleList = [...
    1 3 2 3 1 1;  % Якщо Температура Гаряча і Напір Сильний
    1 2 0 3 1 1;  % Якщо Температура Гаряча і Напір Не дуже сильний
    4 3 3 0 1 1;  % Якщо Температура Не дуже гаряча і Напір Сильний
    4 1 5 5 1 1;  % Якщо Температура Не дуже гаряча і Напір Слабкий
    3 2 4 4 1 1;  % Якщо Температура Тепла і Напір Не дуже сильний
    2 3 5 3 1 1;  % Якщо Температура Прохолодна і Напір Сильний
    2 2 5 3 1 1;  % Якщо Температура Прохолодна і Напір Не дуже сильний
    0 1 5 0 1 1;  % Якщо Температура Холодна і Напір Слабкий
    0 3 3 2 1 1;  % Якщо Температура Холодна і Напір Сильний
    3 3 3 3 1 1;  % Якщо Температура Тепла і Напір Сильний
    3 1 5 5 1 1;  % Якщо Температура Тепла і Напір Слабкий
];

% Додавання правил до FIS
fis = addRule(fis, ruleList);

% Відображення нечіткої системи
ruleview(fis);

% Симуляція системи для деяких вхідних значень
input = [80 8];  % Температура = 80 (Гаряча), Напір = 8 (Сильний)
output = evalfis(fis, input);

% Виведення результатів симуляції
disp(['Поворот гарячого крану: ', num2str(output(1)), ' градусів']);
disp(['Поворот холодного крану: ', num2str(output(2)), ' градусів']);
